!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports):"function"==typeof define&&define.amd?define(["exports"],r):r((t=t||self).ZR={})}(this,function(t){"use strict";function r(t){var r="function"==typeof Symbol&&t[Symbol.iterator],e=0;return r?r.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}function e(t,r){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var n,a,o=e.call(t),i=[];try{for(;(void 0===r||r-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(t){a={error:t}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(a)throw a.error}}return i}function n(){if(!w)throw new Error("Please install router before push.")}function a(t){return{path:t,query:{},params:{}}}function o(t,n){var a,o,i=t.split("?")[0].split("/").filter(Boolean),c=n.split("?")[0].split("/").filter(Boolean);if(i.length!==c.length)return!1;try{for(var u=r(i.entries()),s=u.next();!s.done;s=u.next()){var p=e(s.value,2),l=p[0],f=p[1],h=c[l];if(!f.startsWith(":")&&!h.startsWith(":")&&f!==h)return!1}}catch(t){a={error:t}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}return!0}function i(t,r){var e=t.replace(/(?<start>\/)(?<param>:[^\/\?]+)(?<end>\/?)/,"$1[^/?]+$3");return t.startsWith("^")||t.endsWith("$")||(e="^"+e+"$"),new RegExp(e).test(r)}function c(t){return"zr-if"===t.$options.name}function u(t){return"zr-else"===t.$options.name}function s(t,n){var a,o,i=t.split("/").filter(Boolean),c=n.split("/").filter(Boolean),u={};try{for(var s=r(i.entries()),p=s.next();!p.done;p=s.next()){var l=e(p.value,2),f=l[0],h=l[1],d=c[f];h.startsWith(":")&&(u[h.slice(1)]=d)}}catch(t){a={error:t}}finally{try{p&&!p.done&&(o=s.return)&&o.call(s)}finally{if(a)throw a.error}}return u}function p(t){var n,a,o={},i=t.split("?")[1]||"";try{for(var c=r(i.split("&")),u=c.next();!u.done;u=c.next()){var s=e(u.value.split("="),2),p=s[0],l=s[1];if(p){var f=o[p];"string"==typeof f?o[p]=[f,l]:void 0===f?o[p]=l:f.push(l)}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}return o}function l(t){for(var r=-1,e=Reflect.get,n=t.$parent.$children.findIndex(function(r){return e(r,"zrid")===t.zrid}),a=[],o=n-1;o>-1;o--){var i=t.$parent.$children[o];if(c(i)){r=o;break}if(u(i))break}return-1!==r&&(a=t.$parent.$children.slice(r,n)),a}var f;function h(t,r){if(!o(t,f.current.path)){var e={data:r,path:t,query:p(t),params:{}};f.stack.push(e),f.current=e}}function d(t,r){n(),h(t,r),window.history.pushState(r,"",t)}function v(t,r){n(),h(t,r),window.history.replaceState(r,"",t)}var m=0;function y(){return m++}var w,b={name:"zr-if",provide:function(){return{parentPath:this.path}},inject:{parentPath:{default:""}},props:{path:{required:!0,type:String},component:{type:[Object,String,Function],required:!0}},data:function(){return{matched:!0,zrid:y()}},render:function(t){var r=void 0,e=this.parentPath+this.path,n=f.current.path.replace(new RegExp("^"+f.base),"/");return this.matched=!1,i(e,n)&&(this.matched=!0,f.current.params=s(this.path,f.current.path),r=t(this.component,{props:{route:f.current}})),r}},z={name:"zr-else-if",provide:function(){return{parentPath:this.path}},inject:{parentPath:{default:""}},props:{path:{required:!0,type:String},component:{type:[Object,String,Function],required:!0}},data:function(){return{matched:!0,zrid:y()}},render:function(t){this.matched=!1;var r=void 0,e=this.parentPath+this.path,n=f.current.path.replace(new RegExp("^"+f.base),"/"),a=l(this);return a.length?a.every(function(t){return!t.matched})&&i(e,n)&&(this.matched=!0,f.current.params=s(this.path,f.current.path),r=t(this.component,{props:{route:f.current}})):console.error("\n        In <zr-else-if>: path = "+this.path+", component = "+this.component+".\n        Use <zr-else-if> after at least one <zr-if>.\n      "),r}},g={name:"zr-else",inject:{parentPath:{default:""}},props:{component:{type:[Object,String,Function],required:!0}},data:function(){return{zrid:y()}},render:function(t){var r=void 0,e=l(this);return e.length?e.every(function(t){return!t.matched})&&(r=t(this.component,{props:{route:f.current}})):console.error("\n        In <zr-else>: component = "+this.component+".\n        Use <zr-else> after at least one <zr-if>.\n      "),r}},x={props:{to:String,replace:Boolean},render:function(t){var r=this;return t("a",{on:{click:function(t){t.preventDefault(),r.replace?v(r.to):d(r.to)}}},this.$slots.default)}};var k={install:function(t,r){void 0===r&&(r={}),(w=t).component("zr-if",b),w.component("zr-else-if",z),w.component("zr-else",g),w.component("zr-link",x),function(t){var r=t.base||"/",e=a(r.replace(/\/$/,"")+window.location.pathname);f=w.observable({stack:[e],current:e,base:r}),window.addEventListener("popstate",function(){var t=f.stack.find(function(t){return o(t.path,window.location.pathname)});t?f.current=t:(f.current=a(f.base),f.stack.push(f.current))})}(r)}};t.back=function(){n();var t=f.stack[f.stack.length-2];t&&(f.current=t,window.history.back())},t.default=k,t.forward=function(){n();var t=f.stack.indexOf(f.current);if(t>=0){var r=f.stack[t+1];r&&(f.current=r,window.history.forward())}},t.push=d,t.replace=v,Object.defineProperty(t,"__esModule",{value:!0})});
