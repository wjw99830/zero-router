function t(t){var r="function"==typeof Symbol&&t[Symbol.iterator],e=0;return r?r.call(t):{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}}}function r(t,r){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var n,a,o=e.call(t),i=[];try{for(;(void 0===r||r-- >0)&&!(n=o.next()).done;)i.push(n.value)}catch(t){a={error:t}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(a)throw a.error}}return i}function e(){if(!z)throw new Error("Please install router before push.")}function n(t){return{path:t,query:{},params:{}}}function a(e,n){var a,o,i=e.split("?")[0].split("/").filter(Boolean),c=n.split("?")[0].split("/").filter(Boolean);if(i.length!==c.length)return!1;try{for(var u=t(i.entries()),s=u.next();!s.done;s=u.next()){var p=r(s.value,2),l=p[0],f=p[1],h=c[l];if(!f.startsWith(":")&&!h.startsWith(":")&&f!==h)return!1}}catch(t){a={error:t}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(a)throw a.error}}return!0}function o(t,r){var e=t.replace(/(?<start>\/)(?<param>:[^\/\?]+)(?<end>\/?)/,"$1[^/?]+$3");return t.startsWith("^")||t.endsWith("$")||(e="^"+e+"$"),new RegExp(e).test(r)}function i(t){return"zr-if"===t.$options.name}function c(t){return"zr-else"===t.$options.name}function u(e,n){var a,o,i=e.split("/").filter(Boolean),c=n.split("/").filter(Boolean),u={};try{for(var s=t(i.entries()),p=s.next();!p.done;p=s.next()){var l=r(p.value,2),f=l[0],h=l[1],d=c[f];h.startsWith(":")&&(u[h.slice(1)]=d)}}catch(t){a={error:t}}finally{try{p&&!p.done&&(o=s.return)&&o.call(s)}finally{if(a)throw a.error}}return u}function s(e){var n,a,o={},i=e.split("?")[1]||"";try{for(var c=t(i.split("&")),u=c.next();!u.done;u=c.next()){var s=r(u.value.split("="),2),p=s[0],l=s[1];if(p){var f=o[p];"string"==typeof f?o[p]=[f,l]:void 0===f?o[p]=l:f.push(l)}}}catch(t){n={error:t}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}return o}function p(t){for(var r=-1,e=Reflect.get,n=t.$parent.$children.findIndex(function(r){return e(r,"zrid")===t.zrid}),a=[],o=n-1;o>-1;o--){var u=t.$parent.$children[o];if(i(u)){r=o;break}if(c(u))break}return-1!==r&&(a=t.$parent.$children.slice(r,n)),a}var l;function f(t,r){if(!a(t,l.current.path)){var e={data:r,path:t,query:s(t),params:{}};l.stack.push(e),l.current=e}}function h(t,r){e(),f(t,r),window.history.pushState(r,"",t)}function d(t,r){e(),f(t,r),window.history.replaceState(r,"",t)}function v(){e();var t=l.stack[l.stack.length-2];t&&(l.current=t,window.history.back())}function m(){e();var t=l.stack.indexOf(l.current);if(t>=0){var r=l.stack[t+1];r&&(l.current=r,window.history.forward())}}var y=0;function w(){return y++}var z,b={name:"zr-if",provide:function(){return{parentPath:this.path}},inject:{parentPath:{default:""}},props:{path:{required:!0,type:String},component:{type:[Object,String,Function],required:!0}},data:function(){return{matched:!0,zrid:w()}},render:function(t){var r=void 0,e=this.parentPath+this.path,n=l.current.path.replace(new RegExp("^"+l.base),"/");return this.matched=!1,o(e,n)&&(this.matched=!0,l.current.params=u(this.path,l.current.path),r=t(this.component,{props:{route:l.current}})),r}},g={name:"zr-else-if",provide:function(){return{parentPath:this.path}},inject:{parentPath:{default:""}},props:{path:{required:!0,type:String},component:{type:[Object,String,Function],required:!0}},data:function(){return{matched:!0,zrid:w()}},render:function(t){this.matched=!1;var r=void 0,e=this.parentPath+this.path,n=l.current.path.replace(new RegExp("^"+l.base),"/"),a=p(this);return a.length?a.every(function(t){return!t.matched})&&o(e,n)&&(this.matched=!0,l.current.params=u(this.path,l.current.path),r=t(this.component,{props:{route:l.current}})):console.error("\n        In <zr-else-if>: path = "+this.path+", component = "+this.component+".\n        Use <zr-else-if> after at least one <zr-if>.\n      "),r}},x={name:"zr-else",inject:{parentPath:{default:""}},props:{component:{type:[Object,String,Function],required:!0}},data:function(){return{zrid:w()}},render:function(t){var r=void 0,e=p(this);return e.length?e.every(function(t){return!t.matched})&&(r=t(this.component,{props:{route:l.current}})):console.error("\n        In <zr-else>: component = "+this.component+".\n        Use <zr-else> after at least one <zr-if>.\n      "),r}},$={props:{to:String,replace:Boolean},render:function(t){var r=this;return t("a",{on:{click:function(t){t.preventDefault(),r.replace?d(r.to):h(r.to)}}},this.$slots.default)}};var k={install:function(t,r){void 0===r&&(r={}),(z=t).component("zr-if",b),z.component("zr-else-if",g),z.component("zr-else",x),z.component("zr-link",$),function(t){var r=t.base||"/",e=n(r.replace(/\/$/,"")+window.location.pathname);l=z.observable({stack:[e],current:e,base:r}),window.addEventListener("popstate",function(){var t=l.stack.find(function(t){return a(t.path,window.location.pathname)});t?l.current=t:(l.current=n(l.base),l.stack.push(l.current))})}(r)}};export default k;export{v as back,m as forward,h as push,d as replace};
